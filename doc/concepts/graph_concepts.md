# Graph Concepts

このファイルでは、グラフアルゴリズム（特に最短経路系）で用いる  
**重み付きグラフに関するコンセプト群**を定義している。

これらのコンセプトは、`dijkstra` や `bellman_ford` などのアルゴリズムが  
**どのような型のグラフ・辺・重みを仮定しているかを静的に表現する**ためのものである。



## concept

### `Weight`

`Weight<W>` は、**辺の重みとして用いられる型 `W` に課される制約**を表すコンセプトである。  
このコンセプトは以下を要求する。

- 全順序比較が可能であること（`<`, `<=`, `>` など）
- デフォルト構築が可能であること
- コピー可能であること
- 加算および加算代入が定義されていること（`+`, `+=`）
- `std::numeric_limits<W>` が定義されており、`max()` が取得できること

グラフアルゴリズムでは、  
- `W{}` を **距離の初期値（始点の距離）** として用い、
- `std::numeric_limits<W>::max()` を **到達不能を表すための値**として用いる。

これらの意味論的な性質（`W{}` が単位元であることなど）は  
**コンセプトでは静的に検証されない**ため、利用者が保証する必要がある。



### `WeightedEdge`

`WeightedEdge<E, W>` は、**重み付き辺を表す型 `E`** に課される制約を表す。

このコンセプトは以下を要求する。

- `E` が
  - 行き先頂点を表すメンバ `to` を持ち、`std::size_t` に変換可能であること
  - 重みを表すメンバ `weight` を持ち、型 `W` に変換可能であること
- `W` が `Weight<W>` を満たすこと

このコンセプトにより、  
アルゴリズム側は **辺が「どこへ行き、どれだけコストがかかるか」** を  
共通のインターフェースで扱える。



### `WeightedGraph`

`WeightedGraph<C>` は、**重み付きグラフ全体を表す型 `C`** に課される制約を表す。

このコンセプトは以下を要求する。

- `C` がサイズを持つレンジであること（`std::ranges::sized_range`）
- `C[i]` により、頂点 `i` の隣接辺集合へアクセスできること
- `C[i]` がレンジであり、その要素型が
  - `WeightedEdge` を満たす辺型であること
- 辺の重み型が `Weight` を満たすこと

典型的には、以下のような型が `WeightedGraph` を満たす。

```cpp
std::vector<std::vector<gcl::WEdge<long long>>>
```
このコンセプトにより、
- 隣接リスト
- CSR風の構造
- view / wrapper型

など、具体的な実装に依存しない形で最短経路アルゴリズムを記述出来る。


## 型補助（type traits）

このファイルでは、上記コンセプトを記述するために
以下の型補助（エイリアス）も定義している。

- `adj_range_t<C>`：グラフ C における 1 頂点分の隣接辺レンジの型

- `edge_t<C>`：隣接辺レンジの要素型（辺型）

- `weight_t<C>`：グラフ C が用いる重み型

これらはアルゴリズム実装側で
「グラフから重み型を自動的に抽出する」ために用いられる。


## 位置づけ

これらのコンセプトは 特定のアルゴリズムに依存しないため、`shortest_path`に限らず、

- 最小全域木
- 木・グラフ上の DP
- フロー系アルゴリズム（重み付きの場合）

など、重み付きグラフを扱う他のアルゴリズムでも再利用されることを想定している。